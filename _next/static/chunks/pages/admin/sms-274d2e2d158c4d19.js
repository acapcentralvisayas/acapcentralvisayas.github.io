(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5740],{28359:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/sms",function(){return t(39314)}])},38554:function(e,n){"use strict";n.Z={button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"48px"}},container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",margin:"auto",borderColor:"#E2E8F0"},tabsContainer:{marginTop:function(e){return e.spacing(8)},border:function(e){return"1px solid ".concat(e.palette.bacap.border)},minHeight:"800px",borderRadius:"8px",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px"},customizedButtonLink:{cursor:"pointer",color:"#8BC24A",textDecoration:"underline",fontWeight:600}}},55688:function(e,n,t){"use strict";var r=t(85893),a=t(67294),i=t(45697),o=t.n(i),c=t(14866),s=t(46901);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var u=a.forwardRef((function(e,n){return(0,r.jsx)(s.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){l(e,n,t[n])}))}return e}({elevation:6,ref:n,variant:"filled"},e))}));function d(e){var n=e.openSnackbar,t=e.message,i=e.severity,o=e.closeHandlerCB,s=void 0===o?function(){}:o,l=(0,a.useState)(n),d=l[0],p=l[1];(0,a.useEffect)((function(){p(n)}),[n]);var f=function(){p(!1),s()};return(0,r.jsx)(c.Z,{open:d,autoHideDuration:3e3,onClose:f,children:(0,r.jsx)(u,{onClose:f,severity:i,sx:{width:"100%"},children:t})})}d.propTypes={openSnackbar:o().bool,message:o().string,severity:o().string},n.Z=d},31338:function(e,n,t){"use strict";t.d(n,{x:function(){return c},P:function(){return s}});var r=t(85893),a=t(87357);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=function(e){var n=e.children,t=e.value,c=e.index,s=o(e,["children","value","index"]);return(0,r.jsx)("div",function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){i(e,n,t[n])}))}return e}({role:"tabpanel",hidden:t!==c,id:"custom-tabpanel-".concat(c),"aria-labelledby":"custom-tab-".concat(c)},s,{children:t===c&&(0,r.jsx)(a.Z,{sx:{p:3},children:n})}))};var s=function(e){return{id:"custom-tab-".concat(e),"aria-controls":"custom-tabpanel-".concat(e)}}},39314:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return je}});var r=t(34051),a=t.n(r),i=t(85893),o=t(95243),c=t(67294),s=t(15861),l=t(87357),u=t(88409),d=t(40044),p=t(86886),f=t(31338),h=t(11057),m=t(82280),v=t(38895),x=t(22797),b=t(23508),y=t(50657),g=t(37645),j=t(6514),C=t(58951),S=t(61903),Z=t(31425),w=t(98456),E=t(47312),O=t(69368),k=t(94054),_=t(50480),T=t(40476),R=t(53457),A=t(18972),I=t(18360),N={phonebookContainer:{border:function(e){return"1px solid ".concat(e.palette.bacap.border)},minHeight:"500px",maxHeight:"500px",borderRadius:"8px",background:"#fafafa",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",overflow:"auto"},searchPhonebookTextField:{width:"170px",margin:1,background:"#FFFFFF",position:"absolute",zIndex:1},contactInformationItem:{display:"flex",alignItems:"baseline"}},P=/^09[0-9]{9}$/g,D="Cell number is required.";function M(e,n){var t=e.find((function(e){return e.cellnumber===n}));return Boolean(t)}var L=function(e,n,t,r){if(null!==t){if(""===t)return"ERROR_MISSING_CELLNUMBER";if(function(e){return!e.match(P)}(t))return"ERROR_INVALID_FORMAT_CELLNUMBER";if("EDIT"===e){if(r&&t!==r)return M(n,t)?"ERROR_CONTACT_ALREADY_EXIST":""}else{if("ADD"!==e)return"";if(M(n,t))return"ERROR_CONTACT_ALREADY_EXIST"}}},B=function(e){switch(e){case"ERROR_MISSING_CELLNUMBER":case"ERROR_MISSING_CELLNUMBER":return D;case"ERROR_INVALID_FORMAT_CELLNUMBER":return"Invalid cell number format.";case"ERROR_CONTACT_ALREADY_EXIST":return"Cell number already exists in the conact list.";default:return""}},F=t(38885);function W(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function z(e){return function(e){if(Array.isArray(e))return W(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return W(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return W(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var q=function(e){var n,t,r=e.contacts,a=e.open,o=e.handleClose,u=e.handleAddContact,d=e.loadingButton,p=e.regions,f=e.province,m=e.setProvince,v=e.municipality,x=e.setMunicipality,b=(0,c.useState)(""),P=b[0],D=b[1],M=(0,c.useState)(null),W=M[0],q=M[1],H=(0,c.useState)(""),U=H[0],G=H[1],V=(0,c.useState)([]),Y=V[0],K=V[1],X=(0,c.useState)([]),$=X[0],J=X[1],Q=(0,c.useState)(d),ee=Q[0],ne=Q[1],te=Object.keys(p),re=(0,F.Z)().cropList;(0,c.useEffect)((function(){ne(d)}),[d]),(0,c.useEffect)((function(){Boolean(f)&&K(p[f])}),[f,p]);var ae=function(e){var n=e.target,t=n.value,r=n.checked;J((function(e){return r?z(e).concat([t]):e.filter((function(e){return e!==t}))}))};return(0,i.jsxs)(y.Z,{fullWidth:!0,maxWidth:"xs",open:a,onClose:o,children:[(0,i.jsx)(g.Z,{children:"Add Contact"}),(0,i.jsxs)(j.Z,{children:[(0,i.jsxs)(l.Z,{sx:N.contactInformationItem,children:[(0,i.jsx)(l.Z,{sx:{mr:9},children:(0,i.jsx)(C.Z,{children:"Name:"})}),(0,i.jsx)(S.Z,{id:"outlined-basic",variant:"standard",size:"small",onChange:function(e){D(e.target.value)}})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(l.Z,{sx:N.contactInformationItem,children:[(0,i.jsx)(l.Z,{sx:{mr:3},children:(0,i.jsx)(C.Z,{children:"Cell Number:"})}),(0,i.jsx)(S.Z,{error:(null===(n=L("ADD",r,W,null))||void 0===n?void 0:n.length)>0,helperText:B(L("ADD",r,W)),id:"outlined-basic",variant:"standard",size:"small",onChange:function(e){q(e.target.value)},type:"tel"})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(l.Z,{sx:N.contactInformationItem,children:[(0,i.jsx)(l.Z,{sx:{mr:5},children:(0,i.jsx)(C.Z,{children:":"})}),(0,i.jsx)(S.Z,{id:"outlined-basic",variant:"standard",size:"small",onChange:function(e){G(e.target.value)}})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{variant:"standard",fullWidth:!0,children:[(0,i.jsx)(E.Z,{id:"demo-simple-select-label",children:"Select Province"}),(0,i.jsx)(I.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:f,label:"Province",onChange:function(e){m(e.target.value),x("")},children:te.map((function(e){return(0,i.jsx)(A.Z,{value:e,children:e},e)}))})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{variant:"standard",fullWidth:!0,children:[(0,i.jsx)(E.Z,{id:"demo-simple-select-label",children:"Select Municipality"}),(0,i.jsx)(I.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:v,label:"Municipality",onChange:function(e){x(e.target.value)},disabled:!Boolean(f),children:Y.map((function(e){return(0,i.jsx)(A.Z,{value:e,children:e},e)}))})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{children:[(0,i.jsx)(T.Z,{id:"demo-checkbox-group-label",children:"Subscribed Crops"}),(0,i.jsx)(s.Z,{variant:"caption",children:"Select crops where farmer wants to receive SMS."}),(0,i.jsx)(R.Z,{row:!0,children:re.length?re.map((function(e){return(0,i.jsx)(_.Z,{control:(0,i.jsx)(O.Z,{value:e,checked:$.includes(e),onChange:ae}),label:e},e)})):(0,i.jsx)("p",{children:"No data available."})})]})]}),(0,i.jsxs)(Z.Z,{children:[(0,i.jsx)(h.Z,{disabled:ee,size:"small",onClick:o,children:"CANCEL"}),(0,i.jsxs)(h.Z,{disabled:(null===(t=L("ADD",r,W))||void 0===t?void 0:t.length)>0||null===W||""===f.length||""===v.length||!(U.length>0&&U.length<=5)||0===$.length||ee,size:"small",variant:"contained",onClick:function(){u({name:P,cellnumber:W,nickname:U,province:f,municipality:v,subscribed_crops:$}),D(""),q(null),m(""),x(""),o()},children:[(0,i.jsx)("span",{style:{display:ee?"none":"block"},children:"SAVE"}),(0,i.jsx)(w.Z,{size:24,color:"secondary",sx:{display:ee?"block":"none"}})]})]})]})};function H(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function U(e){return function(e){if(Array.isArray(e))return H(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return H(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return H(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var G=function(e){var n,t,r=e.loadingButton,a=e.open,o=e.contact,u=e.contacts,d=e.handleClose,p=e.handleDeleteContact,f=e.handleEditContact,m=e.regions,v=(0,c.useState)(!1),x=v[0],b=v[1],P=(0,c.useState)(o.name),D=P[0],M=P[1],W=(0,c.useState)(o.cellnumber),z=W[0],q=W[1],H=(0,c.useState)(o.nickname),G=H[0],V=H[1],Y=(0,c.useState)(o.province),K=Y[0],X=Y[1],$=(0,c.useState)(o.municipality),J=$[0],Q=$[1],ee=(0,c.useState)([]),ne=ee[0],te=ee[1],re=(0,c.useState)(r),ae=re[0],ie=re[1],oe=(0,c.useState)(o.subscribed_crops),ce=oe[0],se=oe[1],le=Object.keys(m),ue=(0,F.Z)().cropList;(0,c.useEffect)((function(){se(o.subscribed_crops)}),[o]),(0,c.useEffect)((function(){te(m[K])}),[K,m]),(0,c.useEffect)((function(){M(o.name),q(o.cellnumber),V(o.nickname),X(o.province),Q(o.municipality)}),[o]),(0,c.useEffect)((function(){ie(r)}),[r]);var de=function(e){var n=e.target,t=n.value,r=n.checked;se((function(e){return r?U(e).concat([t]):e.filter((function(e){return e!==t}))}))};return(0,i.jsxs)(y.Z,{fullWidth:!0,maxWidth:"xs",open:a,onClose:d,children:[(0,i.jsx)(g.Z,{children:"Contact Details"}),(0,i.jsxs)(j.Z,{children:[(0,i.jsxs)(l.Z,{sx:N.contactInformationItem,children:[(0,i.jsx)(l.Z,{sx:{mr:9},children:(0,i.jsx)(C.Z,{children:"Name:"})}),(0,i.jsx)(S.Z,{disabled:!x,id:"outlined-basic",onChange:function(e){M(e.target.value)},value:D,variant:"standard",size:"small"})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(l.Z,{sx:N.contactInformationItem,children:[(0,i.jsx)(l.Z,{sx:{mr:3},children:(0,i.jsx)(C.Z,{children:"Cell Number:"})}),(0,i.jsx)(S.Z,{error:(null===(n=L("EDIT",u,z,o.cellnumber))||void 0===n?void 0:n.length)>0,helperText:B(L("EDIT",u,z,o.cellnumber)),onChange:function(e){q(e.target.value)},disabled:!x,id:"outlined-basic",value:z,variant:"standard",size:"small",type:"tel"})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(l.Z,{sx:N.contactInformationItem,children:[(0,i.jsx)(l.Z,{sx:{mr:5},children:(0,i.jsx)(C.Z,{children:"Nickname:"})}),(0,i.jsx)(S.Z,{disabled:!x,id:"outlined-basic",onChange:function(e){V(e.target.value)},value:G,variant:"standard",size:"small"})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{variant:"standard",fullWidth:!0,children:[(0,i.jsx)(E.Z,{id:"demo-simple-select-label",children:"Select Province"}),(0,i.jsx)(I.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:K,label:"Province",onChange:function(e){X(e.target.value),Q("")},disabled:!x,children:le.map((function(e){return(0,i.jsx)(A.Z,{value:e,children:e},e)}))})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{variant:"standard",fullWidth:!0,children:[(0,i.jsx)(E.Z,{id:"demo-simple-select-label",children:"Select Municipality"}),(0,i.jsx)(I.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:J,label:"Municipality",onChange:function(e){Q(e.target.value)},disabled:!x||!Boolean(K),children:ne.map((function(e){return(0,i.jsx)(A.Z,{value:e,children:e},e)}))})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsxs)(k.Z,{children:[(0,i.jsx)(T.Z,{id:"demo-checkbox-group-label",children:"Subscribed Crops"}),(0,i.jsx)(s.Z,{variant:"caption",children:"Select crops where farmer wants to receive SMS."}),(0,i.jsx)(R.Z,{row:!0,children:ue.length?ue.map((function(e){return(0,i.jsx)(_.Z,{control:(0,i.jsx)(O.Z,{value:e,checked:ce.includes(e),onChange:de,disabled:!x}),label:e},e)})):(0,i.jsx)("p",{children:"No data available."})})]})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(Z.Z,{children:[x?(0,i.jsxs)(h.Z,{disabled:(null===(t=L("EDIT",u,z,o.cellnumber))||void 0===t?void 0:t.length)>0||ae,size:"small",variant:"outlined",onClick:function(){return f({id:o.id,name:D,cellnumber:z,nickname:G,province:K,municipality:J,selectedCrops:ce})},children:[(0,i.jsx)("span",{style:{display:ae?"none":"block"},children:"SAVE"}),(0,i.jsx)(w.Z,{size:24,color:"secondary",sx:{display:ae?"block":"none"}})]}):(0,i.jsx)(h.Z,{disabled:ae,size:"small",variant:"outlined",onClick:function(){b(!0),q(o.cellnumber)},children:"EDIT"}),x?(0,i.jsx)(h.Z,{disabled:ae,size:"small",variant:"outlined",onClick:function(){M(o.name),q(o.cellnumber),X(o.province),Q(o.municipality),b(!1)},children:"CANCEL"}):(0,i.jsxs)(h.Z,{disabled:ae,size:"small",color:"error",variant:"outlined",onClick:function(){return p(o)},children:[(0,i.jsx)("span",{style:{display:ae?"none":"block"},children:"DELETE"}),(0,i.jsx)(w.Z,{size:24,color:"secondary",sx:{display:ae?"block":"none"}})]}),(0,i.jsx)(h.Z,{disabled:ae,size:"small",onClick:d,children:"CLOSE"})]})]})},V=t(55688);var Y=function(e){var n=e.handleAddContact,t=e.handleDeleteContact,r=e.handleEditContact,a=e.loading,o=e.loadingButton,s=e.open,l=e.originalContacts,u=e.setOpen,d=e.regions,p=e.province,f=e.setProvince,y=e.municipality,g=e.setMunicipality,j=(0,c.useState)(null),C=j[0],S=j[1],Z=(0,c.useState)(l),w=Z[0],E=Z[1],O=(0,c.useState)(null),k=O[0],_=O[1],T=(0,c.useState)(!1),R=T[0],A=T[1],I=(0,c.useState)(!1),N=I[0],P=I[1],D=(0,c.useState)({}),M=D[0],L=D[1];(0,c.useEffect)((function(){E(l)}),[l]),(0,c.useEffect)((function(){0!==l.length&&B(l)}),[B,l]);var B=(0,c.useCallback)((function(e){var n=e.reduce((function(e,n){return e[n.province]||(e[n.province]={}),e[n.province][n.municipality]||(e[n.province][n.municipality]=[]),e[n.province][n.municipality].push(n),e}),{});_(n)}),[_]);return(0,i.jsxs)("div",{children:[N&&Object.entries(M).length>0&&(0,i.jsx)(V.Z,{openSnackbar:!0,message:M.message,severity:M.severity}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.Z,{variant:"contained",color:"primary",onClick:function(){A(!0),f(""),g("")},children:"ADD CONTACT"}),(0,i.jsx)(q,{contacts:l,open:R,handleClose:function(){A(!1)},handleAddContact:n,loadingButton:o,regions:d,province:p,setProvince:f,municipality:y,setMunicipality:g})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)("div",{style:{width:"30vw"},children:a?"Updating List...":(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:k&&Object.keys(k).sort().map((function(e,n){return(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(v.Z,{expandIcon:(0,i.jsx)(b.Z,{}),"aria-controls":"panel1-content",id:"panel1-header",children:(0,i.jsx)("strong",{children:e})}),(0,i.jsx)(x.Z,{children:Object.keys(k[e]).sort().map((function(n){return(0,i.jsxs)("div",{children:[(0,i.jsx)("i",{children:n}),k[e][n].map((function(e){return(0,i.jsx)("ul",{children:(0,i.jsxs)("li",{style:{cursor:"pointer"},onClick:function(){return function(e){P(!1),L({}),u(!0),S(e)}(e)},children:[e.name," (",e.nickname,")"]})},e.cellnumber)}))]},n)}))})]},n)}))}),C&&(0,i.jsx)(G,{contact:C,contacts:w,handleClose:function(){u(!1),S(null)},handleDeleteContact:t,handleEditContact:r,loadingButton:o,open:s,regions:d})]})})]})},K=t(9473),X=t(24343),$=t(27392);var J=function(e){var n=e.columns,t=e.loadingReports,r=e.rows,a=e.handleReportTypeChange,o=(0,c.useState)($.Ry.SEASONAL),s=o[0],l=o[1],u=(0,K.v9)((function(e){return e.dashboard.reportType}));return(0,c.useEffect)((function(){l(u)}),[u]),(0,i.jsxs)("div",{children:[n.length>0&&(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"10px"},children:(0,i.jsxs)(k.Z,{sx:{m:1,width:{xs:"100%",sm:"100%",md:300}},size:"small",children:[(0,i.jsx)(E.Z,{id:"report-type",children:"Bulletin Type"}),(0,i.jsxs)(I.Z,{labelId:"report-type",id:"report-type",value:s,label:"Bulletin Type",onChange:a,children:[(0,i.jsx)(A.Z,{value:$.Ry.SEASONAL,children:"Seasonal Crop Recommendations"}),(0,i.jsx)(A.Z,{value:$.Ry.TEN_DAY,children:"10-Day Crop Recommendations"}),(0,i.jsx)(A.Z,{value:$.Ry.SPECIAL_WEATHER,children:"Special Weather Recommendations"})]})]})}),(0,i.jsx)("div",{style:{height:400,width:"100%"},children:(0,i.jsx)(X._,{rows:r,columns:n,loading:t,pageSize:5,rowsPerPageOptions:[5]})})]})},Q=t(38554);function ee(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ne(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){ee(e,n,t[n])}))}return e}var te=function(e){var n=e.columns,t=e.contacts,r=e.getContacts,a=e.handleAddContact,o=e.handleDeleteContact,h=e.handleEditContact,m=e.handleOpenAddContact,v=e.handleReportTypeChange,x=e.loading,b=e.loadingButton,y=e.loadingReports,g=e.open,j=e.rows,C=e.setOpen,S=e.toAddContact,Z=e.regions,w=e.province,E=e.setProvince,O=e.municipality,k=e.setMunicipality,_=(0,c.useState)(S?1:0),T=_[0],R=_[1];return(0,i.jsxs)("div",{children:[(0,i.jsx)(s.Z,{variant:"h5",children:"SMS Management"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"View Text (SMS) versions"})," of generated Crop Recommendations and send them to different individuals via SMS."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Manage your own phonebook"})," for ease of sending texts to individuals."]}),(0,i.jsxs)(l.Z,{sx:Q.Z.tabsContainer,children:[(0,i.jsxs)(u.Z,{value:T,onChange:function(e,n){R(n)},"aria-label":"basic tabs example",children:[(0,i.jsx)(d.Z,ne({label:"SMS"},(0,f.P)(0))),(0,i.jsx)(d.Z,ne({label:"PHONEBOOK"},(0,f.P)(1)))]}),(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(f.x,{value:T,index:0,children:(0,i.jsx)(J,{columns:n,handleReportTypeChange:v,loadingReports:y,rows:j})}),(0,i.jsx)(f.x,{value:T,index:1,children:(0,i.jsx)(p.ZP,{container:!0,children:(0,i.jsx)(p.ZP,{item:!0,xs:12,md:4,children:(0,i.jsx)(Y,{getContacts:r,handleAddContact:a,handleDeleteContact:o,handleEditContact:h,handleOpenAddContact:m,loading:x,loadingButton:b,open:g,originalContacts:t,setOpen:C,regions:Z,province:w,setProvince:E,municipality:O,setMunicipality:k})})})})]})]})]})},re=t(66383),ae=t(53063),ie=t(47426),oe=t(77715),ce=t(63835),se=t(16327),le=t(40558),ue=t(11163),de=t(87006),pe=t(72882),fe=t(55113),he=t(7906),me=t(53184),ve=t(53816),xe=t(53252),be=t(295);function ye(e,n,t,r,a,i,o){try{var c=e[i](o),s=c.value}catch(l){return void t(l)}c.done?n(s):Promise.resolve(s).then(r,a)}function ge(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function o(e){ye(i,r,a,o,c,"next",e)}function c(e){ye(i,r,a,o,c,"throw",e)}o(void 0)}))}}var je=(0,o.Z)((function(e){var n=e.loading,t=e.user,r=e.onBtnLogoutClick,o=(0,ce.aC)(),u=(0,ue.useRouter)(),d=(0,K.I0)(),p=(0,c.useState)([]),f=p[0],m=p[1],v=(0,c.useState)([]),x=v[0],b=v[1],C=(0,c.useState)([]),S=C[0],w=C[1],E=(0,c.useState)([]),O=E[0],k=E[1],_=(0,c.useState)(!1),T=_[0],R=_[1],A=(0,c.useState)(!1),I=A[0],N=A[1],P=(0,c.useState)({}),D=P[0],M=P[1],L=(0,c.useState)(!1),B=L[0],F=L[1],W=(0,c.useState)(!1),z=W[0],q=W[1],H=(0,c.useState)([]),U=H[0],G=H[1],Y=(0,c.useState)(!1),X=Y[0],$=Y[1],J=(0,K.v9)((function(e){return e.dashboard.reportType})),Q=(0,c.useState)([]),ee=Q[0],ne=Q[1],ye=(0,c.useState)(""),je=ye[0],Ce=ye[1],Se=(0,c.useState)(""),Ze=Se[0],we=Se[1],Ee=function(){var e=ge(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,F(!0),e.next=4,(0,le.K2)();case 4:n=e.sent,k(n),F(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Oe=function(e){var n=e.logs;return(0,i.jsx)(pe.Z,{component:fe.Z,children:(0,i.jsxs)(he.Z,{sx:{minWidth:650},"arial-label":"simple-table",children:[(0,i.jsx)(me.Z,{children:(0,i.jsxs)(ve.Z,{children:[(0,i.jsx)(xe.Z,{children:"Number"}),(0,i.jsxs)(xe.Z,{children:["Date\xa0",(0,i.jsx)("span",{style:{fontSize:"10px"},children:"(MM/DD/YYYY)"})]}),(0,i.jsx)(xe.Z,{children:"Message"}),(0,i.jsx)(xe.Z,{children:"Recipients"})]})}),(0,i.jsx)(be.Z,{children:n.map((function(e,n){var t=JSON.parse(e),r=new Date(t.dateSent).toLocaleString();return(0,i.jsxs)(ve.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,i.jsx)(xe.Z,{component:"th",scope:"row",children:n+1}),(0,i.jsx)(xe.Z,{children:r}),(0,i.jsxs)(xe.Z,{children:[(0,i.jsx)(l.Z,{sx:{whiteSpace:"pre-wrap"},dangerouslySetInnerHTML:{__html:'\n                          <strong>Crop:</strong> <span style="margin-left: 121px;">'.concat(U.crop,'</span>\n                          <strong>Province:</strong> <span style="margin-left: 95px;">').concat(U.province,'</span>\n                          <strong>Month:</strong> <span style="margin-left: 110px;">').concat(U.month,'</span>\n                          <strong>Climate Risk:</strong> <span style="margin-left: 70px;">').concat(U.risk,'</span>\n                          <strong>Weather Data Validity:</strong> <span style="margin-left: 12px;">').concat(U.date_range,'</span>\n                          <strong>Weather Conditions:</strong> <span style="margin-left: 24px;">').concat(U.rainfall,'</span>\n                          <strong>CIS Type:</strong> <span style="margin-left: 94px;">').concat(U.type,"</span>\n                          ").concat(t.sentMessage||"<i>No message available.</i>","\n                        ")}})," "]}),(0,i.jsx)(xe.Z,{children:t.recipientsWithName||t.recipientsNumber})]},t.dateSent)}))})]})})},ke=function(e){var n=e.report;return(0,i.jsxs)(y.Z,{fullWidth:!0,maxWidth:"md",open:z,onClose:Ne,children:[(0,i.jsx)(g.Z,{children:"SMS Recommendation Logs"}),(0,i.jsxs)(j.Z,{dividers:!0,children:[(0,i.jsx)(s.Z,{variant:"body2",children:"This is where you can check where you send your texts message."}),(0,i.jsx)("br",{}),(0,i.jsx)(Oe,{logs:null===n||void 0===n?void 0:n.logs})]}),(0,i.jsx)(Z.Z,{children:(0,i.jsx)(h.Z,{variant:"outlined",onClick:Ne,children:"Close"})})]})};(0,c.useEffect)((function(){if(null!==o.user&&!o.loading){var e=function(){var e=ge(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,de._8)(o.user.uid);case 3:n=e.sent,w(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e(),Ee()}}),[o]),(0,c.useEffect)((function(){if(S.length>0){var e=S.filter((function(e){return e.type===J}));_e(e)}}),[S]),(0,c.useEffect)((function(){var e=function(){var e=ge(a().mark((function e(){var n,t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,se.ur)();case 3:n=e.sent,ne(null!==(t=null===n||void 0===n?void 0:n.data)&&void 0!==t?t:[]),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var _e=function(e){var n={action:"Action",logs:"Logs",crop:"Crop",text_recommendation:"Text-Form Recommendation",region:"Region",province:"Province",municipality:"Municipality",month:"Month",risk:"Climate Risk",date_range:"Weather Data Validity",rainfall:"Weather Conditions",type:"Type",updated_by:"Updated by",date_created:"Date Created"},t=[];["action","logs","crop","text_recommendation","region","province","municipality","month","risk","date_range","rainfall","type","updated_by","date_created"].forEach((function(e){"action"===e?t.push({field:e,headerName:n[e],width:100,editable:!1,sortable:!1,disableColumnMenu:!0,renderCell:function(e){return(0,i.jsx)(h.Z,{variant:"outlined",size:"small",onClick:function(n){n.stopPropagation(),u.push({pathname:"/admin/sms/viewSMS/",query:{docId:e.row.docId}})},children:"SEND"})}}):"logs"===e?t.push({field:e,headerName:n[e],width:100,editable:!1,sortable:!1,disableColumnMenu:!0,renderCell:function(e){var n;return(null===(n=e.row.logs)||void 0===n?void 0:n.length)>0?(0,i.jsx)(h.Z,{variant:"outlined",size:"small",onClick:function(){q(!0),G(e.row)},children:"VIEW LOGS"}):(0,i.jsx)(l.Z,{sx:{fontWeight:"bold"},children:"UNSENT"})}}):"text_recommendation"===e?t.push({field:e,headerName:n[e],width:300,editable:!1,sortable:!1,disableColumnMenu:!0,renderCell:function(e){return(0,i.jsx)(l.Z,{sx:{whiteSpace:"pre-wrap"},dangerouslySetInnerHTML:{__html:e.row.text_recommendation||"<i>No SMS Recommendations available.</i>"}})}}):t.push({field:e,headerName:n[e],width:150,editable:!1,sortable:!1,disableColumnMenu:!0})}));var r=e.map((function(e,n){return{id:n,docId:e.id,logs:e.logs,crop:e.crop,text_recommendation:"\n          Crop: ".concat(e.crop||"N/A","\n          Province: ").concat(e.province||"N/A","\n          Month: ").concat(e.month||"N/A","\n          Climate Risk: ").concat(e.risk||"N/A","\n          Weather Data Validity: ").concat(e.date_range||"N/A","\n          Weather Conditions: ").concat(e.rainfall||"N/A","\n          Type: ").concat(e.type||"N/A","\n          ").concat(e.recommendations||"No SMS Recommendations available","\n        "),region:e.region,province:e.province,municipality:e.municipality,month:e.month,risk:e.risk,date_range:e.date_range,rainfall:e.rainfall,type:e.type,updated_by:e.updated_by,date_created:"".concat(e.date_created.toDate().toDateString(),"\n          ").concat(e.date_created.toDate().toLocaleTimeString("it-IT",oe.W6))}}));m(r),b(t)};(0,c.useEffect)((function(){void 0===Object.keys(u.query)[0]&&(R(!1),M({})),"isSent"===Object.keys(u.query)[0]&&(F(!1),R(!0),Te({message:"true"===u.query.isSent?"Successfully sent Crop Recommendation via text!":"Unsuccessful in sending Crop Recommendation via text.",severity:"true"===u.query.isSent?"success":"error"}))}),[u]),(0,c.useEffect)((function(){o.loading||o.user||u.push("/admin/login")}),[o.user,o.loading,u]);var Te=function(e){M(e)},Re=function(){var e=ge(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,$(!0),e.next=4,(0,le.rE)(n);case 4:if(!e.sent){e.next=8;break}return e.next=8,Ee();case 8:$(!1),R(!0),M({message:"Successfully added a New Contact!",severity:"success"}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(n){return e.apply(this,arguments)}}(),Ae=function(){var e=ge(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,$(!0),e.next=4,(0,le.GK)({docId:n.id});case 4:if(t=e.sent,N(!1),!t){e.next=9;break}return e.next=9,Ee();case 9:$(!1),R(!0),M({openSnackbar:!0,message:"Successfully deleted contact: ".concat(""===n.name?n.cellnumber:n.name,"!"),severity:"success"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(n){return e.apply(this,arguments)}}(),Ie=function(){var e=ge(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,$(!0),e.next=4,(0,le.mP)({docId:n.id,name:n.name,cellnumber:n.cellnumber,nickname:n.nickname,province:n.province,municipality:n.municipality,subscribed_crops:n.selectedCrops});case 4:if(t=e.sent,$(!1),N(!1),!t){e.next=10;break}return e.next=10,Ee();case 10:R(!0),M({openSnackbar:!0,message:"Successfully edit contact: ".concat(""===n.name?n.cellnumber:n.name,"!"),severity:"success"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(n){return e.apply(this,arguments)}}(),Ne=function(){q(!1)};return(0,i.jsxs)(re.Z,{loading:n,user:t,onBtnLogoutClick:r,accLevel:ie.DW.ADMIN,children:[(0,i.jsx)(ke,{report:U}),(0,i.jsx)(te,{columns:x,contacts:O,getContacts:Ee,handleAddContact:Re,handleDeleteContact:Ae,handleEditContact:Ie,handleReportTypeChange:function(e){var n=e.target.value,t=S.filter((function(e){return e.type===n}));G(_e(t)),d((0,ae.uq)(n))},loading:B,loadingReports:n,onBtnClick:r,open:I,rows:f,setOpen:N,toAddContact:u.query.toAddContact,user:o.user,loadingButton:X,regions:ee,province:je,setProvince:Ce,municipality:Ze,setMunicipality:we}),!B&&T&&(0,i.jsx)(V.Z,{openSnackbar:!0,message:D.message,severity:D.severity,closeHandler:function(){R(!1)}})]})}))},38885:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(34051),a=t.n(r),i=t(67294),o=t(32848);function c(e,n,t,r,a,i,o){try{var c=e[i](o),s=c.value}catch(l){return void t(l)}c.done?n(s):Promise.resolve(s).then(r,a)}function s(){var e=(0,i.useState)([]),n=e[0],t=e[1],r=(0,i.useState)(!1),s=r[0],l=r[1],u=(0,i.useState)(""),d=u[0],p=u[1];return(0,i.useEffect)((function(){var e=function(){var e,n=(e=a().mark((function e(){var n,r,i,c,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l(!0),e.next=4,(0,o.TQ)();case 4:n=e.sent,t(null!==(r=null===n||void 0===n?void 0:n.list)&&void 0!==r?r:[]),l(!1),p(""),e.next=19;break;case 11:e.prev=11,e.t0=e.catch(0),s=null!==(c=null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i?void 0:i.data)&&void 0!==c?c:e.t0.message,p(s),l(!1),t([]);case 19:case"end":return e.stop()}}),e,null,[[0,11]])})),function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function o(e){c(i,r,a,o,s,"next",e)}function s(e){c(i,r,a,o,s,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();e()}),[]),{cropList:n,loading:s,error:d}}},40558:function(e,n,t){"use strict";t.d(n,{rE:function(){return C},GK:function(){return S},mP:function(){return Z},K2:function(){return w}});var r=t(34051),a=t.n(r),i=t(9669),o=t.n(i),c=t(99431);function s(e,n,t,r,a,i,o){try{var c=e[i](o),s=c.value}catch(l){return void t(l)}c.done?n(s):Promise.resolve(s).then(r,a)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function o(e){s(i,r,a,o,c,"next",e)}function c(e){s(i,r,a,o,c,"throw",e)}o(void 0)}))}}function u(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function d(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function h(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){p(e,n,t[n])}))}return e}function m(e,n){return!n||"object"!==x(n)&&"function"!==typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function v(e,n){return v=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},v(e,n)}var x=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function b(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=f(e);if(n){var a=f(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return m(this,t)}}var y={BASE_API_URL:"https://amia-cis-j6uv.onrender.com/api",CREATE_CONTACT:"".concat("https://amia-cis-j6uv.onrender.com/api","/contact"),DELETE_CONTACT:"".concat("https://amia-cis-j6uv.onrender.com/api","/contact"),EDIT_CONTACT:"".concat("https://amia-cis-j6uv.onrender.com/api","/contact"),GET_CONTACTS:"".concat("https://amia-cis-j6uv.onrender.com/api","/contacts"),PHONEBOOK:"phonebook"},g=function(e){!function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&v(e,n)}(c,e);var n,t,r,i=b(c);function c(){return u(this,c),i.apply(this,arguments)}return n=c,(t=[{key:"createContact",value:function(e){var n=this;return l(a().mark((function t(){var r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.createRequestObject({body:e});case 2:return r=t.sent,t.next=5,o()(h({},r,{url:y.CREATE_CONTACT,method:"POST"}));case 5:return i=t.sent,t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t)})))()}},{key:"deleteContact",value:function(e){var n=this;return l(a().mark((function t(){var r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.createRequestObject({body:e});case 2:return r=t.sent,t.next=5,o()(h({},r,{url:y.DELETE_CONTACT,method:"DELETE"}));case 5:return i=t.sent,t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t)})))()}},{key:"editContact",value:function(e){var n=this;return l(a().mark((function t(){var r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.createRequestObject({body:e});case 2:return r=t.sent,t.next=5,o()(h({},r,{url:y.EDIT_CONTACT,method:"PATCH"}));case 5:return i=t.sent,t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t)})))()}},{key:"getContacts",value:function(){var e=this;return l(a().mark((function n(){var t,r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.createRequestObject({});case 2:return t=n.sent,n.next=5,o()(h({},t,{url:y.GET_CONTACTS,method:"GET"}));case 5:return r=n.sent,n.abrupt("return",r.data.contacts);case 7:case"end":return n.stop()}}),n)})))()}}])&&d(n.prototype,t),r&&d(n,r),c}(c.Z),j=new g,C=j.createContact.bind(j),S=j.deleteContact.bind(j),Z=j.editContact.bind(j),w=j.getContacts.bind(j)}},function(e){e.O(0,[5778,2702,8858,1903,6279,7944,542,6295,1433,6572,2719,9821,4343,5478,1050,9774,2888,179],(function(){return n=28359,e(e.s=n);var n}));var n=e.O();_N_E=n}]);